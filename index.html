<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Carrom Game</title>
<style>
    body {
        margin: 0;
        background: #222;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
    }
    canvas {
        background: #deb887;
        border: 12px solid #5a2d0c;
        border-radius: 12px;
    }
</style>
</head>
<body>

<canvas id="board" width="500" height="500"></canvas>

<script>
const canvas = document.getElementById("board");
const ctx = canvas.getContext("2d");

const friction = 0.99;
const coins = [];
const pockets = [
    {x:20,y:20},{x:480,y:20},{x:20,y:480},{x:480,y:480}
];

// Coin class
class Coin {
    constructor(x,y,r,color){
        this.x=x; this.y=y;
        this.r=r;
        this.dx=0; this.dy=0;
        this.color=color;
        this.active=true;
    }
    draw(){
        if(!this.active) return;
        ctx.beginPath();
        ctx.arc(this.x,this.y,this.r,0,Math.PI*2);
        ctx.fillStyle=this.color;
        ctx.fill();
    }
    move(){
        if(!this.active) return;
        this.x+=this.dx;
        this.y+=this.dy;
        this.dx*=friction;
        this.dy*=friction;

        // wall bounce
        if(this.x<this.r||this.x>500-this.r) this.dx*=-1;
        if(this.y<this.r||this.y>500-this.r) this.dy*=-1;

        // pocket check
        for(let p of pockets){
            let d=Math.hypot(this.x-p.x,this.y-p.y);
            if(d<15){
                this.active=false;
            }
        }
    }
}

// Striker
const striker = new Coin(250,420,12,"white");

// Coins setup
for(let i=0;i<6;i++){
    coins.push(new Coin(240+i*6,250,8,"black"));
    coins.push(new Coin(260-i*6,250,8,"white"));
}
coins.push(new Coin(250,250,9,"red")); // queen

let dragging=false;
let startX,startY;

// Mouse controls
canvas.addEventListener("mousedown",e=>{
    let rect=canvas.getBoundingClientRect();
    let x=e.clientX-rect.left;
    let y=e.clientY-rect.top;
    if(Math.hypot(x-striker.x,y-striker.y)<striker.r){
        dragging=true;
        startX=x; startY=y;
    }
});

canvas.addEventListener("mouseup",e=>{
    if(dragging){
        let rect=canvas.getBoundingClientRect();
        let x=e.clientX-rect.left;
        let y=e.clientY-rect.top;
        striker.dx=(startX-x)/5;
        striker.dy=(startY-y)/5;
        dragging=false;
    }
});

// Collision logic
function collide(a,b){
    if(!a.active||!b.active) return;
    let d=Math.hypot(a.x-b.x,a.y-b.y);
    if(d<a.r+b.r){
        let angle=Math.atan2(b.y-a.y,b.x-a.x);
        let speed1=Math.hypot(a.dx,a.dy);
        let speed2=Math.hypot(b.dx,b.dy);
        a.dx=speed2*Math.cos(angle);
        a.dy=speed2*Math.sin(angle);
        b.dx=speed1*Math.cos(angle+Math.PI);
        b.dy=speed1*Math.sin(angle+Math.PI);
    }
}

function drawBoard(){
    ctx.clearRect(0,0,500,500);

    // pockets
    ctx.fillStyle="black";
    for(let p of pockets){
        ctx.beginPath();
        ctx.arc(p.x,p.y,15,0,Math.PI*2);
        ctx.fill();
    }

    striker.draw();
    striker.move();

    for(let c of coins){
        c.draw();
        c.move();
        collide(striker,c);
        for(let o of coins){
            if(c!==o) collide(c,o);
        }
    }
    requestAnimationFrame(drawBoard);
}

drawBoard();
</script>

</body>
</html>
