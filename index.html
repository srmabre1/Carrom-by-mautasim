<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ARCHITECT PRO | V21</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;900&display=swap');
        :root { --p: #00d4ff; --bg: #0a0e17; --c: #141b26; --sl: #dee3e6; --sd: #769656; }
        body { margin: 0; background: var(--bg); color: white; font-family: 'Orbitron', sans-serif; display: flex; flex-direction: column; align-items: center; height: 100vh; overflow: hidden; }
        
        .architect-tag { font-size: 24px; font-weight: 900; color: var(--p); text-shadow: 0 0 10px var(--p); letter-spacing: 4px; margin: 15px 0; animation: glowPulse 2s infinite ease-in-out; }
        @keyframes glowPulse { 0%, 100% { opacity: 0.8; text-shadow: 0 0 5px var(--p); } 50% { opacity: 1; text-shadow: 0 0 20px var(--p); } }

        .overlay { position: fixed; inset: 0; background: var(--bg); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 100; padding: 20px; text-align: center; }
        .auth-card { background: var(--c); padding: 30px; border-radius: 20px; width: 100%; max-width: 340px; border: 1px solid #222; box-shadow: 0 10px 50px rgba(0,0,0,0.8); }
        
        input { background: #000; border: 1px solid var(--p); color: white; padding: 14px; margin: 10px 0; width: 100%; border-radius: 10px; text-align: center; font-family: 'Orbitron'; font-size: 12px; box-sizing: border-box; }
        .btn-main { width: 100%; padding: 16px; background: var(--p); color: #000; border: none; border-radius: 10px; font-family: 'Orbitron'; font-weight: 900; cursor: pointer; margin-top: 10px; }
        
        /* Board & Hud */
        .hud { width: 100%; background: var(--c); padding: 15px; display: flex; justify-content: space-between; border-bottom: 2px solid var(--p); box-sizing: border-box; margin-top: 60px; font-size: 12px; font-weight: 900; }
        #board-box { margin: 15px 0; width: 92vw; max-width: 380px; aspect-ratio: 1; border: 4px solid var(--c); position: relative; border-radius: 8px; overflow: hidden; }
        #board { display: grid; grid-template-columns: repeat(8, 1fr); grid-template-rows: repeat(8, 1fr); height: 100%; }
        .sq { display: flex; justify-content: center; align-items: center; position: relative; }
        .sq.l { background: var(--sl); } .sq.d { background: var(--sd); }
        .sq.hint::after { content: ''; width: 14px; height: 14px; background: var(--p); border-radius: 50%; opacity: 0.6; box-shadow: 0 0 8px var(--p); }
        .selected { background: rgba(0, 212, 255, 0.4) !important; }
        img.piece { width: 90%; z-index: 5; filter: drop-shadow(0 0 2px rgba(255,255,255,0.4)); }
        .black { filter: invert(1) brightness(0.9) drop-shadow(0 0 2px var(--p)) !important; }

        /* Victory Screen */
        #win-screen { background: rgba(10, 14, 23, 0.95); display: none; }
        .win-title { font-size: 32px; color: var(--p); margin-bottom: 10px; }
        .win-name { font-size: 20px; color: white; margin-bottom: 30px; }
    </style>
</head>
<body onclick="initAudio()">

    <div id="auth-screen" class="overlay">
        <div class="architect-tag">ARCHITECT PRO</div>
        <div class="auth-card">
            <input type="text" id="user-in" placeholder="SYSTEM IDENTITY">
            <button class="btn-main" onclick="handleAuth()">INITIALIZE</button>
        </div>
    </div>

    <div id="home-screen" class="overlay" style="display:none">
        <div class="architect-tag">MAUTASIM</div>
        <div class="auth-card">
            <button class="btn-main" onclick="openSetup('bot')">NEURAL AI</button>
            <button class="btn-main" onclick="openSetup('pass')">LOCAL PASS & PLAY</button>
            <button class="btn-main" onclick="location.reload()" style="background:none; border:1px solid #444; color:#777">LOGOUT</button>
        </div>
    </div>

    <div id="setup-screen" class="overlay" style="display:none">
        <div class="auth-card">
            <h3 style="color:var(--p); font-size:14px;">IDENTIFY COMBATANTS</h3>
            <div id="bot-names">
                <input type="text" id="ai-p1" placeholder="YOUR NAME">
                <p style="font-size:10px; color:#555;">VS NEURAL CORE AI</p>
            </div>
            <div id="pass-names" style="display:none">
                <input type="text" id="pass-p1" placeholder="PLAYER 1 (WHITE)">
                <input type="text" id="pass-p2" placeholder="PLAYER 2 (BLACK)">
            </div>
            <button class="btn-main" onclick="confirmStart()">ENGAGE</button>
            <button class="btn-main" style="background:none; border:1px solid #444; color:#777" onclick="cancelSetup()">BACK</button>
        </div>
    </div>

    <div id="win-screen" class="overlay">
        <div class="win-title">VICTORY</div>
        <div class="win-name" id="winner-display">PLAYER 1 WINS</div>
        <button class="btn-main" style="width:200px" onclick="location.reload()">HOME</button>
    </div>

    <div class="hud">
        <div id="label-w">---</div>
        <div style="color:var(--p)">VS</div>
        <div id="label-b">---</div>
    </div>
    <div id="board-box"><div id="board"></div></div>

<script>
    const game = new Chess();
    const boardEl = document.getElementById('board');
    let currentUser = null, currentMode = 'bot', selectedSq = null, audioCtx = null;
    let names = { w: "PLAYER 1", b: "PLAYER 2" };

    function initAudio() { if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)(); }
    function playSfx(type) {
        if(!audioCtx) return;
        const o = audioCtx.createOscillator(), g = audioCtx.createGain();
        o.connect(g); g.connect(audioCtx.destination);
        if(type === 'move') { o.frequency.value = 400; g.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + 0.1); }
        if(type === 'cap') { o.frequency.setValueAtTime(600, audioCtx.currentTime); o.frequency.exponentialRampToValueAtTime(200, audioCtx.currentTime + 0.2); g.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + 0.2); }
        if(type === 'win') { o.frequency.setValueAtTime(800, audioCtx.currentTime); o.frequency.exponentialRampToValueAtTime(1200, audioCtx.currentTime + 0.5); g.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + 0.5); }
        o.start(); o.stop(audioCtx.currentTime + 0.5);
    }

    function handleAuth() {
        currentUser = document.getElementById('user-in').value.toUpperCase() || "ARCHITECT";
        document.getElementById('auth-screen').style.display = 'none';
        document.getElementById('home-screen').style.display = 'flex';
    }

    function openSetup(mode) {
        currentMode = mode;
        document.getElementById('home-screen').style.display = 'none';
        document.getElementById('setup-screen').style.display = 'flex';
        document.getElementById('bot-names').style.display = (mode === 'bot') ? 'block' : 'none';
        document.getElementById('pass-names').style.display = (mode === 'pass') ? 'block' : 'none';
        document.getElementById('ai-p1').value = currentUser;
    }

    function cancelSetup() {
        document.getElementById('setup-screen').style.display = 'none';
        document.getElementById('home-screen').style.display = 'flex';
    }

    function confirmStart() {
        if(currentMode === 'bot') {
            names.w = document.getElementById('ai-p1').value || currentUser;
            names.b = "NEURAL AI";
        } else {
            names.w = document.getElementById('pass-p1').value || "PLAYER 1";
            names.b = document.getElementById('pass-p2').value || "PLAYER 2";
        }
        document.getElementById('label-w').innerText = names.w;
        document.getElementById('label-b').innerText = names.b;
        document.getElementById('setup-screen').style.display = 'none';
        game.reset(); initBoard();
    }

    function initBoard() {
        boardEl.innerHTML = '';
        for (let i = 0; i < 64; i++) {
            const r = Math.floor(i/8), c = i%8;
            const sq = document.createElement('div');
            sq.className = `sq ${(r + c) % 2 === 0 ? 'l' : 'd'}`;
            sq.dataset.id = String.fromCharCode(97 + c) + (8 - r);
            sq.onclick = () => handleInput(sq.dataset.id);
            boardEl.appendChild(sq);
        }
        render();
    }

    function handleInput(id) {
        if (selectedSq) {
            const captured = game.get(id);
            const move = game.move({ from: selectedSq, to: id, promotion: 'q' });
            if (move) {
                captured ? playSfx('cap') : playSfx('move');
                selectedSq = null; render();
                if (currentMode === 'bot' && !game.game_over()) setTimeout(aiMove, 600);
                return;
            }
        }
        const p = game.get(id);
        if (p && p.color === game.turn()) { selectedSq = id; render(); }
        else { selectedSq = null; render(); }
    }

    function aiMove() {
        const moves = game.moves();
        const move = moves[Math.floor(Math.random() * moves.length)];
        const targetSq = move.includes('x') ? 'cap' : 'move';
        game.move(move);
        playSfx(targetSq);
        render();
    }

    function render() {
        document.querySelectorAll('.sq').forEach(s => {
            const p = game.get(s.dataset.id); 
            s.innerHTML = ''; 
            s.classList.toggle('selected', s.dataset.id === selectedSq);
            s.classList.toggle('hint', selectedSq && game.moves({square: selectedSq}).some(m => m.includes(s.dataset.id)));
            if (p) {
                const img = document.createElement('img');
                img.src = `https://raw.githubusercontent.com/lichess-org/lila/master/public/piece/alpha/${p.color}${p.type.toUpperCase()}.svg`;
                img.className = 'piece' + (p.color === 'b' ? ' black' : '');
                s.appendChild(img);
            }
        });

        if (game.game_over()) {
            playSfx('win');
            let winner = game.in_checkmate() ? (game.turn() === 'w' ? names.b : names.w) : "DRAW";
            document.getElementById('winner-display').innerText = winner === "DRAW" ? "MATCH ENDED IN A DRAW" : winner + " IS VICTORIOUS";
            document.getElementById('win-screen').style.display = 'flex';
        }
    }
</script>
</body>
</html>
